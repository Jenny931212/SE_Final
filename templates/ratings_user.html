{% extends "base.html" %}
{% block content %}

<h2>{{ role_label }}評價：{{ target.username }}</h2>

{% if not stats or stats.cnt == 0 %}
  <p class="muted">目前還沒有任何評價。</p>
{% else %}
  <p>共有 {{ stats.cnt }} 筆評價記錄。</p>

  <table>
    <tr>
      <th>評分項目</th>
      <th>平均分數（1~5）</th>
    </tr>
    <tr>
      <td>{{ dim_labels[0] }}</td>
      <td>{{ "%.1f"|format(stats.avg1 or 0) }}</td>
    </tr>
    <tr>
      <td>{{ dim_labels[1] }}</td>
      <td>{{ "%.1f"|format(stats.avg2 or 0) }}</td>
    </tr>
    <tr>
      <td>{{ dim_labels[2] }}</td>
      <td>{{ "%.1f"|format(stats.avg3 or 0) }}</td>
    </tr>
  </table>

<h3 style="margin-top:20px;">所有質性評論</h3>

{% if items and items|length > 0 %}
  <table style="width:100%; border-collapse:collapse; margin-top:12px;">
    <tr>
      <th style="width:120px;">評價者</th>
      <th style="width:160px;">案件</th>
      <th style="width:200px;">分數</th>
      <th>評論內容</th>
      <th style="width:160px;">時間</th>
    </tr>

    {% for r in items %}
      <tr>
        <td>{{ r.rater_username }}</td>

        <td>{{ r.project_title }}</td>

        <td>
          {{ dim_labels[0] }} {{ r.score_1 }}<br>
          {{ dim_labels[1] }} {{ r.score_2 }}<br>
          {{ dim_labels[2] }} {{ r.score_3 }}
        </td>

        <td>
          {{ r.comment or "（無留言）" }}
        </td>

        <td>
          {{ r.created_at.strftime("%Y-%m-%d %H:%M") }}
        </td>
      </tr>
    {% endfor %}
  </table>
{% else %}
  <p class="muted">目前尚無任何評價。</p>
{% endif %}

{% endif %}

<p>
  <a href="{{ next_url or '/dashboard' }}" class="btn secondary">返回</a>
</p>

{% endblock %}
